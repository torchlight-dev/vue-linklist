!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.VueLinkList={})}(this,function(e){"use strict";function t(){var e=document.head||document.getElementsByTagName("head")[0],n=t.styles||(t.styles={}),i="undefined"!=typeof navigator&&/msie [6-9]\\b/.test(navigator.userAgent.toLowerCase());return function(t,r){if(!document.querySelector('style[data-vue-ssr-id~="'+t+'"]')){var a=i?r.media||"default":t,s=n[a]||(n[a]={ids:[],parts:[],element:void 0});if(!s.ids.includes(t)){var o=r.source,c=s.ids.length;if(s.ids.push(t),i&&(s.element=s.element||document.querySelector("style[data-group="+a+"]")),!s.element){var d=s.element=document.createElement("style");d.type="text/css",r.media&&d.setAttribute("media",r.media),i&&(d.setAttribute("data-group",a),d.setAttribute("data-next-index","0")),e.appendChild(d)}if(i&&(c=parseInt(s.element.getAttribute("data-next-index")),s.element.setAttribute("data-next-index",c+1)),s.element.styleSheet)s.parts.push(o),s.element.styleSheet.cssText=s.parts.filter(Boolean).join("\n");else{var l=document.createTextNode(o),u=s.element.childNodes;u[c]&&s.element.removeChild(u[c]),u.length?s.element.insertBefore(l,u[c]):s.element.appendChild(l)}}}}}var n={props:{source:{type:Array,required:!0},width:{type:[Number,String],default:640},height:{type:[Number,String],default:480},box:{type:Object,default:function(){return{width:100,height:50,margin:10,space:80}}},defaultPairs:{type:Array,default:function(){return[]}}},data:function(){return{active:{},pairs:[]}},updated:function(){Array.isArray(this.defaultPairs)&&0===this.pairs.length&&(this.pairs=this.defaultPairs)},computed:{lines:function(){var e=this;return this.pairs.map(function(t){return{start:Object.assign(t.start,e.findElementIndex(t.start)),end:Object.assign(t.end,e.findElementIndex(t.end))}})}},methods:{findElementIndex:function(e){var t=e.category,n=e.name,i=this.source.findIndex(function(e){return e.category===t});return{categoryIndex:i,nameIndex:this.source[i].elements.findIndex(function(e){return e.name===n})}},hasConnected:function(e){var t=e.start,n=e.end;return!!this.pairs.find(function(e){return e.start.category===t.category&&e.start.name===t.name&&e.end.category===n.category&&e.end.name===n.name})},onStartClicked:function(e,t){this.$set(this.active,"category",e),this.$set(this.active,"name",t)},onEndClicked:function(e,t){if(this.active.category&&this.active.name){var n=this.findElementIndex({category:this.active.category,name:this.active.name});this.findElementIndex({category:e,name:t}).categoryIndex-n.categoryIndex==1&&(this.hasConnected({start:this.active,end:{category:e,name:t}})||(this.pairs.push({start:{category:this.active.category,name:this.active.name},end:{category:e,name:t}}),this.active={},this.noticeToParent()))}},onLineClicked:function(e){this.removeLine(e)},removeLine:function(e){this.pairs=this.pairs.filter(function(t){return t.start.category!==e.start.category||t.start.name!==e.start.name||t.end.category!==e.end.category||t.end.name!==e.end.name}),this.noticeToParent()},noticeToParent:function(){this.$emit("updatedList",this.pairs)},categoryX:function(e){return(this.box.width+this.box.space)*e},elementY:function(e){return(this.box.height+this.box.margin)*e},elementTransform:function(e){return"translate(0, "+this.elementY(e)+")"},categoryTransform:function(e){return"translate("+this.categoryX(e)+", 0)"}}},i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("svg",{attrs:{width:e.width,height:e.height,xmlns:"http://www.w3.org/2000/svg"}},[n("g",{attrs:{transform:"translate(20, 20)"}},[e._l(e.lines,function(t){return n("line",{attrs:{x1:e.categoryX(t.start.categoryIndex)+e.box.width,y1:e.elementY(t.start.nameIndex)+e.box.height/2,x2:e.categoryX(t.end.categoryIndex),y2:e.elementY(t.end.nameIndex)+e.box.height/2,"stroke-width":"10",stroke:"rgb(119, 0, 255)"},on:{click:function(n){e.onLineClicked(t)}}})}),e._l(e.source,function(t,i){return n("g",{attrs:{transform:e.categoryTransform(i)}},[e._l(t.elements,function(r,a){return[n("g",{attrs:{transform:e.elementTransform(a)}},[n("rect",{attrs:{height:e.box.height,width:e.box.width,x:"0",y:"0","stroke-width":"1.5",stroke:"#000",fill:"#fff"}}),n("foreignObject",{attrs:{width:e.box.width,height:e.box.height}},[e._t("default",null,{element:r,categoryIndex:i,elementIndex:a,xmlns:"http://www.w3.org/1999/xhtml"})],2),i!==e.source.length-1?n("circle",{class:{active:e.active.category===t.category&&e.active.name===r.name},attrs:{cx:e.box.width,cy:e.box.height/2,r:"10"},on:{click:function(n){e.onStartClicked(t.category,r.name)}}}):e._e(),0!==i?n("circle",{class:{active:!1},attrs:{cx:0,cy:e.box.height/2,r:"10"},on:{click:function(n){e.onEndClicked(t.category,r.name)}}}):e._e()],1)]})],2)})],2)])},r=[];i._withStripped=!0;var a=function(e,t,n,i,r,a,s,o){var c=("function"==typeof n?n.options:n)||{};c.__file="/Users/genichiro/git/vue-linklist/src/linklist.vue",c.render||(c.render=e.render,c.staticRenderFns=e.staticRenderFns,c._compiled=!0,r&&(c.functional=!0)),c._scopeId=i;var d;if(t&&(d=function(e){t.call(this,s(e))}),void 0!==d)if(c.functional){var l=c.render;c.render=function(e,t){return d.call(t),l(e,t)}}else{var u=c.beforeCreate;c.beforeCreate=u?[].concat(u,d):[d]}return c}({render:i,staticRenderFns:r},function(e){e&&e("data-v-3f287e8a_0",{source:"\ncircle[data-v-3f287e8a] {\n  fill: #333;\n  transition: all 0.4s cubic-bezier(0.17, 0.67, 0.88, 1.74);\n  stroke: #7700ff;\n  stroke-width: 1px;\n}\n.active[data-v-3f287e8a] {\n  fill: white;\n  stroke-width: 5px;\n}\nline[data-v-3f287e8a]:hover {\n  stroke: #9f64ff;\n}\n\n/*# sourceMappingURL=linklist.vue.map */",map:{version:3,sources:["/Users/genichiro/git/vue-linklist/src/linklist.vue","linklist.vue"],names:[],mappings:";AA6KA;EACA,WAAA;EACA,0DAAA;EACA,gBAAA;EACA,kBAAA;CACA;AACA;EACA,YAAA;EACA,kBAAA;CACA;AACA;EACA,gBAAA;CACA;;AC5KA,wCAAwC",file:"linklist.vue",sourcesContent:[null,"circle {\n  fill: #333;\n  transition: all 0.4s cubic-bezier(0.17, 0.67, 0.88, 1.74);\n  stroke: #7700ff;\n  stroke-width: 1px; }\n\n.active {\n  fill: white;\n  stroke-width: 5px; }\n\nline:hover {\n  stroke: #9f64ff; }\n\n/*# sourceMappingURL=linklist.vue.map */"]},media:void 0})},n,"data-v-3f287e8a",!1,void 0,t,void 0);e.default=a,Object.defineProperty(e,"__esModule",{value:!0})});
